<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="f4b2171b-3524-4e7f-a37d-41b86b877c3d" activeEnvironment="Default" name="Loginbuddy" resourceRoot="" soapui-version="5.5.0" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config"><con:description>These tests are testing the actual APIs that are available with a 'naked' loginbuddy container</con:description><con:settings/><con:testSuite id="4a865942-cb14-4c71-a231-e663ef0b89a3" name="TomcatHardening"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="0e7aa1e9-6a95-437d-b934-21d1bd2f2d7b" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="SSL only" searchProperties="true"><con:settings/><con:testStep type="httprequest" name="http-index.html" id="7bf727db-b720-475c-9de7-42ce698079c9"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="d66398fb-dbd7-4b5b-82de-d11c8adf2dbc" name="http-index.html" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Only https must work, not http</con:description><con:settings><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#host_http}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="9125eafa-8379-4d40-b214-bfe277f953c1" name="status=302"><con:configuration><codes>302</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:testStep type="httprequest" name="http-authorize" id="03295f56-18f9-4b10-be92-e32d8db76095"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="d66398fb-dbd7-4b5b-82de-d11c8adf2dbc" name="http-authorize" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Only https must work, not http</con:description><con:settings><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#host_http}/authorize</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="9125eafa-8379-4d40-b214-bfe277f953c1" name="status=302"><con:configuration><codes>302</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:testStep type="httprequest" name="http-js" id="a438577d-9e49-4ac0-b635-7bc90f04cdbd"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="b4ade445-3ce8-4f1f-8c9e-ea381f2b75fb" name="http-js" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Only https must work, not http</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host_http}/js/bootstrap.js</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="758b7faf-ab21-4c72-88df-e9efc30cedc0" name="status=200"><con:configuration><codes>302</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:testStep type="httprequest" name="http-callback" id="4b317150-54d4-4687-9299-ac7bfa6652bf"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="d66398fb-dbd7-4b5b-82de-d11c8adf2dbc" name="http-callback" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Only https must work, not http</con:description><con:settings><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#host_http}/callback</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="9125eafa-8379-4d40-b214-bfe277f953c1" name="status=302"><con:configuration><codes>302</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="23b08099-435b-43c6-8235-6df73e8a77da" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="HTTP permitted" searchProperties="true"><con:settings/><con:testStep type="httprequest" name="http-css" id="f5e579b8-c4ad-41da-a127-d94c71c6c255"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="b4ade445-3ce8-4f1f-8c9e-ea381f2b75fb" name="http-css" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Http must work</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host_http}/css/bootstrap.css</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="758b7faf-ab21-4c72-88df-e9efc30cedc0" name="status=200"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:testStep type="httprequest" name="http-fonts" id="19ee7951-3777-4b4b-ac81-c4fb7bc6d626"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="b4ade445-3ce8-4f1f-8c9e-ea381f2b75fb" name="http-fonts" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Http must work</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host_http}/fonts/glyphicons-halflings-regular.ttf</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="758b7faf-ab21-4c72-88df-e9efc30cedc0" name="status=200"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:testStep type="httprequest" name="http-images" id="30db2a73-63af-46a4-9458-59a9fb357b33"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="b4ade445-3ce8-4f1f-8c9e-ea381f2b75fb" name="http-images" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Http must work</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host_http}/images/server_loginbuddy.png</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="758b7faf-ab21-4c72-88df-e9efc30cedc0" name="status=200"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:testStep type="httprequest" name="http-favicon" id="e9393b8b-6564-4c6e-9372-6447388aafdc"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="b4ade445-3ce8-4f1f-8c9e-ea381f2b75fb" name="http-favicon" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Http must work</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host_http}/favicon.ico</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="758b7faf-ab21-4c72-88df-e9efc30cedc0" name="status=200"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:testSuite id="264feb2e-b849-434d-8045-fb32f1f878af" name="Authorize"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="72581314-f239-4c1c-b092-376c02469e63" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="ListProviders" searchProperties="true"><con:settings/><con:testStep type="httprequest" name="GET all providers" id="30c85011-b19b-4c97-a140-523a952beff6"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="1d62ccf8-ba2e-4f67-afbe-506b00e5bfc2" name="GET all providers" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Retrieve providers as html page using GET</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_authorize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="57d1b086-4baa-486a-a5b5-96ed3534922c" name="status: 200"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" id="4a47981c-984a-4549-8570-588127fbfe39" name="contains: &lt;html>"><con:configuration><token>&lt;html></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="3213c463-ca0b-4318-bf4f-a1393baf7e1d" name="contains: method=post"><con:configuration><token>method="post"</token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>state</con:name><con:value>${#Project#state}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_id</con:name><con:value>${#Project#client_id}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>response_type</con:name><con:value>code</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="POST all providers" id="72ed06cb-c52a-4b29-be5d-03eccfd20474"><con:settings/><con:config method="POST" xsi:type="con:HttpRequest" id="1d62ccf8-ba2e-4f67-afbe-506b00e5bfc2" name="POST all providers" postQueryString="true" mediaType="application/x-www-form-urlencoded" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Retrieve providers as html page using POST</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_authorize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="57d1b086-4baa-486a-a5b5-96ed3534922c" name="status: 200"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" id="4a47981c-984a-4549-8570-588127fbfe39" name="contains: &lt;html>"><con:configuration><token>&lt;html></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="3213c463-ca0b-4318-bf4f-a1393baf7e1d" name="contains: method=post"><con:configuration><token>method="post"</token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>state</con:name><con:value>${#Project#state}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_id</con:name><con:value>${#Project#client_id}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>response_type</con:name><con:value>code</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="GET named provider" id="d4f3f2fc-8c96-4dec-bcee-2b7bb74f0594"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="1d62ccf8-ba2e-4f67-afbe-506b00e5bfc2" name="GET named provider" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Retrieve
  providers as html page using GET with selected provider</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">true</con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_authorize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="57d1b086-4baa-486a-a5b5-96ed3534922c" name="status: 200"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" id="4a47981c-984a-4549-8570-588127fbfe39" name="contains: Welcome to Fake provider"><con:configuration><token>Login with Loginbuddy-Demoserver!</token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="3213c463-ca0b-4318-bf4f-a1393baf7e1d" name="contains: method=post"><con:configuration><token>method="post"</token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>state</con:name><con:value>${#Project#state}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>provider</con:name><con:value>${#Project#provider_test}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_id</con:name><con:value>${#Project#client_id}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>response_type</con:name><con:value>code</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="GET pkce with plain - unsupported" id="4aacfcf4-dd26-48f5-a528-436c9795a20f"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="1d62ccf8-ba2e-4f67-afbe-506b00e5bfc2" name="GET pkce with plain - unsupported" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Requesting the list of providers with pkce 'code_challenge_method=plain' which is not supported</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_authorize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="57d1b086-4baa-486a-a5b5-96ed3534922c" name="status: 302"><con:configuration><codes>302</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="a9cab4ae-edc0-4855-8201-e8e69bd93e2b" name="error: unspported"><con:configuration><scriptText>// Find the 'Location' header of the response
    assert messageExchange.responseHeaders["Location"] != null

    def location = messageExchange.responseHeaders["Location"][0]

    // Check if all expected parameters are included in the redirect_uri
    assert(location.contains("error"));
    assert(location.contains("error_description=invalid+or+unsupported+code_challenge_method+parameter+or+value"));</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>state</con:name><con:value>${#Project#state}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>provider</con:name><con:value>${#Project#provider_test}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>code_challenge</con:name><con:value>0123456789012345678901234567890123456789012</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>code_challenge_method</con:name><con:value>plain</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_id</con:name><con:value>${#Project#client_id}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>response_type</con:name><con:value>code</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="GET pkce - code_challenge too short (42)" id="0e5a8cfa-b5ec-4464-a85e-aab55bc411c1"><con:settings/><con:config method="POST" xsi:type="con:HttpRequest" id="1d62ccf8-ba2e-4f67-afbe-506b00e5bfc2" name="GET pkce - code_challenge too short (42)" postQueryString="true" mediaType="application/x-www-form-urlencoded" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Requesting the list of providers with pkce 'code_challenge_method=plain' which is not supported</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_authorize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="57d1b086-4baa-486a-a5b5-96ed3534922c" name="status: 302"><con:configuration><codes>302</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="a9cab4ae-edc0-4855-8201-e8e69bd93e2b" name="error: unspported"><con:configuration><scriptText>// Find the 'Location' header of the response
    assert messageExchange.responseHeaders["Location"] != null

    def location = messageExchange.responseHeaders["Location"][0]

    // Check if all expected parameters are included in the redirect_uri
    assert(location.contains("error"));
    assert(location.contains("error_description=invalid+code_challenge"));</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>state</con:name><con:value>${#Project#state}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>provider</con:name><con:value>${#Project#provider_test}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>code_challenge</con:name><con:value>012345678901234567890123456789012345678901</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>code_challenge_method</con:name><con:value>s256</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_id</con:name><con:value>${#Project#client_id}</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="GET Missing Response_Type" id="882278d8-9fdd-4909-b09f-98b4532d564e"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="1d62ccf8-ba2e-4f67-afbe-506b00e5bfc2" name="GET Missing Response_Type" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Retrieve providers as html page using GET</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_authorize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="57d1b086-4baa-486a-a5b5-96ed3534922c" name="status: 302"><con:configuration><codes>302</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="cd9b6d91-87e5-4ba5-b8d0-7231fae87614" name="Missing response_type parameter"><con:configuration><scriptText>// Find the 'Location' header of the response
    assert messageExchange.responseHeaders["Location"] != null

    def location = messageExchange.responseHeaders["Location"][0]

    // Check if all expected parameters are included in the redirect_uri
    assert(location.contains("error"));
    assert(location.contains("error_description=invalid+or+unsupported+response_type+parameter+or+value"));</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>state</con:name><con:value>${#Project#state}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_id</con:name><con:value>${#Project#client_id}</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="GET Invalid Response_Type" id="2dc21ceb-9a24-4989-8485-c5a5fa1fe5f8"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="1d62ccf8-ba2e-4f67-afbe-506b00e5bfc2" name="GET Invalid Response_Type" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Retrieve providers as html page using GET</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_authorize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="57d1b086-4baa-486a-a5b5-96ed3534922c" name="status: 302"><con:configuration><codes>302</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="cd9b6d91-87e5-4ba5-b8d0-7231fae87614" name="Missing response_type parameter"><con:configuration><scriptText>// Find the 'Location' header of the response
    assert messageExchange.responseHeaders["Location"] != null

    def location = messageExchange.responseHeaders["Location"][0]

    // Check if all expected parameters are included in the redirect_uri
    assert(location.contains("error"));
    assert(location.contains("error_description=unsupported+response_type:+token"));</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>state</con:name><con:value>${#Project#state}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_id</con:name><con:value>${#Project#client_id}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>response_type</con:name><con:value>token</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="5d51f12a-692f-4396-8a53-98ff17cf1c82" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Fail-ListProviders" searchProperties="true"><con:settings/><con:testStep type="httprequest" name="Missing state" id="d6647b45-4052-422f-96f2-7191afbe634a"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="1d62ccf8-ba2e-4f67-afbe-506b00e5bfc2" name="Missing state" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>MUST fail - missing state parameter</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_authorize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="57d1b086-4baa-486a-a5b5-96ed3534922c" name="status: 302"><con:configuration><codes>302</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="fa0461d7-15cf-4508-bee9-b34774edf00d" name="find: error and error_description"><con:configuration><scriptText>// Find the 'Location' header of the response
    assert messageExchange.responseHeaders["Location"] != null

    def location = messageExchange.responseHeaders["Location"][0]

    // Check if all expected parameters are included in the redirect_uri
    assert(location.contains("error=invalid_request"));
    assert(location.contains("error_description=missing+or+invalid+state+parameter"));</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_id</con:name><con:value>${#Project#client_id}</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="Missing client_id" id="1ad1035e-50ee-42d9-a083-41bb2934685e"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="1d62ccf8-ba2e-4f67-afbe-506b00e5bfc2" name="Missing client_id" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>MUST fail - missing state parameter</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_authorize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="57d1b086-4baa-486a-a5b5-96ed3534922c" name="status: 400"><con:configuration><codes>400</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" id="4a47981c-984a-4549-8570-588127fbfe39" name="contains: &lt;html>"><con:configuration><token>&lt;html</token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="3213c463-ca0b-4318-bf4f-a1393baf7e1d" name="contains: missing redirect_uri parameter"><con:configuration><token>Missing or invalid client_id parameter</token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>state</con:name><con:value>stateParameterTwo</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="Missing redirect_uri" id="5eac7072-74b7-44e5-a64a-11cbefc3e28c"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="1d62ccf8-ba2e-4f67-afbe-506b00e5bfc2" name="Missing redirect_uri" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>MUST fail - missing state parameter</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_authorize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="57d1b086-4baa-486a-a5b5-96ed3534922c" name="status: 400"><con:configuration><codes>400</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" id="4a47981c-984a-4549-8570-588127fbfe39" name="contains: &lt;html>"><con:configuration><token>&lt;html</token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="3213c463-ca0b-4318-bf4f-a1393baf7e1d" name="contains: missing redirect_uri parameter"><con:configuration><token>Missing or invalid redirect_uri parameter</token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>state</con:name><con:value>stateParameterTwo</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_id</con:name><con:value>${#Project#client_id}</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="Duplicate state" id="41537ea6-5821-49b8-994b-0b79b0a571d3"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="1d62ccf8-ba2e-4f67-afbe-506b00e5bfc2" name="Duplicate state" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>MUST fail - missing state parameter</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_authorize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="57d1b086-4baa-486a-a5b5-96ed3534922c" name="status: 302"><con:configuration><codes>302</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="274c70ff-e00c-4803-963b-e3044bf27e23" name="find: error and error_description"><con:configuration><scriptText>// Find the 'Location' header of the response
    assert messageExchange.responseHeaders["Location"] != null

    def location = messageExchange.responseHeaders["Location"][0]

    // Check if all expected parameters are included in the redirect_uri
    assert(location.contains("error=invalid_request"));
    assert(location.contains("error_description=missing+or+invalid+state+parameter"));</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>state</con:name><con:value>stateParameterOne</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>state</con:name><con:value>stateParameterTwo</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_id</con:name><con:value>${#Project#client_id}</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="Duplicate redirect_uri" id="5169e1ad-55d0-451a-8fe5-5324a877bb34"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="1d62ccf8-ba2e-4f67-afbe-506b00e5bfc2" name="Duplicate redirect_uri" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>MUST fail - missing state parameter</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_authorize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="57d1b086-4baa-486a-a5b5-96ed3534922c" name="status: 400"><con:configuration><codes>400</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" id="4a47981c-984a-4549-8570-588127fbfe39" name="contains: &lt;html>"><con:configuration><token>&lt;html</token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="3213c463-ca0b-4318-bf4f-a1393baf7e1d" name="contains: missing redirect_uri parameter"><con:configuration><token>Missing or invalid redirect_uri parameter</token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>state</con:name><con:value>stateParameterTwo</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_id</con:name><con:value>${#Project#client_id}</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="Duplicate client_id" id="936fa5bb-b200-4e82-a493-3e2816433ab9"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="1d62ccf8-ba2e-4f67-afbe-506b00e5bfc2" name="Duplicate client_id" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>MUST fail - missing state parameter</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_authorize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="57d1b086-4baa-486a-a5b5-96ed3534922c" name="status: 400"><con:configuration><codes>400</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" id="4a47981c-984a-4549-8570-588127fbfe39" name="contains: &lt;html>"><con:configuration><token>&lt;html</token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="3213c463-ca0b-4318-bf4f-a1393baf7e1d" name="contains: missing redirect_uri parameter"><con:configuration><token>Missing or invalid client_id parameter</token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>state</con:name><con:value>stateParameterTwo</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_id</con:name><con:value>${#Project#client_id}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_id</con:name><con:value>${#Project#client_id}</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="Duplicate provider" id="eedd6c4b-1365-4975-a7a3-f08f9d5a9a0a"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="1d62ccf8-ba2e-4f67-afbe-506b00e5bfc2" name="Duplicate provider" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>MUST fail - missing state parameter</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_authorize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="57d1b086-4baa-486a-a5b5-96ed3534922c" name="status: 302"><con:configuration><codes>302</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="60d8c9c3-0073-4c8f-aa37-bc330523741f" name="find: error and error_description"><con:configuration><scriptText>//Find the 'Location' header of the response
  assert messageExchange.responseHeaders["Location"] != null

  def location = messageExchange.responseHeaders["Location"][0]

  // Check if all expected parameters are included in the redirect_uri
  assert(location.contains("error=invalid_request"));
  assert(location.contains("error_description=invalid+provider+parameter"));</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>provider</con:name><con:value>${#Project#provider_test}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>provider</con:name><con:value>${#Project#provider_test}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>state</con:name><con:value>${#Project#state}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_id</con:name><con:value>${#Project#client_id}</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="Empty state" id="669cac3d-efd1-4362-b5d5-1371d60f4318"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="1d62ccf8-ba2e-4f67-afbe-506b00e5bfc2" name="Empty state" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>MUST fail - missing state parameter</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_authorize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="57d1b086-4baa-486a-a5b5-96ed3534922c" name="status: 302"><con:configuration><codes>302</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="10d151a1-478a-4c19-9abf-08415c41d017" name="find: error and error_description"><con:configuration><scriptText>// Find the 'Location' header of the response
    assert messageExchange.responseHeaders["Location"] != null

    def location = messageExchange.responseHeaders["Location"][0]

    // Check if all expected parameters are included in the redirect_uri
    assert(location.contains("error=invalid_request"));
    assert(location.contains("error_description=missing+or+invalid+state+parameter"));</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>provider</con:name><con:value>${#Project#provider_test}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>state</con:name><con:value/><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_id</con:name><con:value>${#Project#client_id}</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="Empty redirect_uri" id="6903b41c-8226-40ec-b930-c58e6cb9ceb5"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="1d62ccf8-ba2e-4f67-afbe-506b00e5bfc2" name="Empty redirect_uri" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>MUST fail - missing state parameter</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_authorize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="57d1b086-4baa-486a-a5b5-96ed3534922c" name="status: 400"><con:configuration><codes>400</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" id="4a47981c-984a-4549-8570-588127fbfe39" name="contains: &lt;html>"><con:configuration><token>&lt;html</token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="3213c463-ca0b-4318-bf4f-a1393baf7e1d" name="contains: invalid redirect_uri"><con:configuration><token>Missing or invalid redirect_uri parameter</token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>provider</con:name><con:value>${#Project#provider_test}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>state</con:name><con:value>${#Project#state}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>redirect_uri</con:name><con:value/><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_id</con:name><con:value>${#Project#client_id}</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="Empty client_id" id="6b847763-88ac-4d79-ab79-36535bc261e3"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="1d62ccf8-ba2e-4f67-afbe-506b00e5bfc2" name="Empty client_id" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>MUST fail - missing state parameter</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_authorize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="57d1b086-4baa-486a-a5b5-96ed3534922c" name="status: 400"><con:configuration><codes>400</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" id="4a47981c-984a-4549-8570-588127fbfe39" name="contains: &lt;html>"><con:configuration><token>&lt;html</token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="3213c463-ca0b-4318-bf4f-a1393baf7e1d" name="contains: invalid redirect_uri"><con:configuration><token>Missing or invalid client_id parameter</token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>provider</con:name><con:value>${#Project#provider_test}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>state</con:name><con:value>${#Project#state}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_id</con:name><con:value/><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:testSuite id="310951a3-794f-4c0e-9289-7e1eef01b00d" name="InternalAPIs"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="f5e98378-4fea-4b96-827f-a6c47718bb66" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Non-Accessible" searchProperties="true"><con:settings/><con:testStep type="httprequest" name="Providers.jsp" id="3ef0fcb9-218a-4717-a4a1-8cd7568e7ac9"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="b62be840-19d0-4e44-aed2-be2a9098b078" name="Providers.jsp" timeout="" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Must not be accessible</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_providers_jsp}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="69583970-a178-4a87-960f-a91c31ca7605" name="status:403, access denied"><con:configuration><codes>403</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:testStep type="httprequest" name="Errors.jsp" id="bed36fc9-ef1a-43c9-83cd-15c13da7cf38"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="f1872651-3ba5-4043-8bb6-c8bd5f5d0ad3" name="Errors.jsp" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Must not be accessible</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding xsi:nil="true"/><con:endpoint>${#Project#host}${#Project#path_error_jsp}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="9f400019-86ea-468f-8e20-ee8eababfb7e" name="status: 403, access denied"><con:configuration><codes>403</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:testSuite id="b004caea-efda-4cd4-a275-ba283ac86c52" name="Token"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="c44956cc-c77c-4768-ab7d-b6388308c60b" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="ExchangeCode" searchProperties="true"><con:settings/><con:testStep type="httprequest" name="MissingCode" id="b0b2e409-6027-43dd-956e-5db18333053f"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="8dd778c4-bf24-4181-b9db-361ca0bccfb9" name="MissingCode" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Must fail due to missing code</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_token}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="aae1ee1c-57a7-45c0-bde2-08b6d8a282d5" name="status: 400"><con:configuration><codes>400</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="55794519-0536-4c2d-bcba-ee2e356c7731" name="content-type: application/json"><con:configuration><scriptText>// Check content-type
assert messageExchange.responseHeaders["Content-Type"].get(0).startsWith("application/json")</scriptText></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="298a8951-57ba-42e5-80d3-4488e99f2cee" name="find: error"><con:configuration><path>error</path><content>invalid_request</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:testStep type="httprequest" name="DuplicateCode" id="056c6f3b-fbee-44a6-b1cb-9c63aeac6d6e"><con:settings/><con:config method="POST" xsi:type="con:HttpRequest" id="8dd778c4-bf24-4181-b9db-361ca0bccfb9" name="DuplicateCode" postQueryString="true" mediaType="application/x-www-form-urlencoded" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Must fail due to duplicate code parameter</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_token}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="aae1ee1c-57a7-45c0-bde2-08b6d8a282d5" name="status: 400"><con:configuration><codes>400</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="55794519-0536-4c2d-bcba-ee2e356c7731" name="content-type: application/json"><con:configuration><scriptText>// Check content-type
assert messageExchange.responseHeaders["Content-Type"].get(0).startsWith("application/json")</scriptText></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="298a8951-57ba-42e5-80d3-4488e99f2cee" name="find: error"><con:configuration><path>error</path><content>invalid_request</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>code</con:name><con:value>unknowncode1</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>code</con:name><con:value>unknowncode2</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="UnknownCode" id="5cbf2e35-dfb4-4e03-9f09-ae49128a525c"><con:settings/><con:config method="POST" xsi:type="con:HttpRequest" id="8dd778c4-bf24-4181-b9db-361ca0bccfb9" name="UnknownCode" postQueryString="true" mediaType="application/x-www-form-urlencoded" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Must fail due to unknown code value</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_token}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="aae1ee1c-57a7-45c0-bde2-08b6d8a282d5" name="status: 400"><con:configuration><codes>400</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="55794519-0536-4c2d-bcba-ee2e356c7731" name="content-type: application/json"><con:configuration><scriptText>// Check content-type
assert messageExchange.responseHeaders["Content-Type"].get(0).startsWith("application/json")</scriptText></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="298a8951-57ba-42e5-80d3-4488e99f2cee" name="find: error"><con:configuration><path>error</path><content>invalid_request</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>code</con:name><con:value>unknowncode1</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:testSuite id="213c82e2-b574-43d9-a022-007a275b111c" name="Initialize"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="79476cb5-58bf-4f12-8162-3b2f25d592f5" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Initialize" searchProperties="true"><con:settings/><con:testStep type="httprequest" name="MissingSession" id="81e50e69-025e-4d4a-86d9-09c2a166f512"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="82940ef5-951e-4615-b686-9c5583880b72" name="MissingSession" timeout="" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Must fail due to missing session</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_initialize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="74892484-7dbc-470d-92fe-88b1e6d0da8d" name="status: 400"><con:configuration><codes>400</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="c65a42cd-db65-41fc-973d-ed1b13015d71" name="content-type: text/html"><con:configuration><scriptText>// Check content-type
assert messageExchange.responseHeaders["Content-Type"].get(0).startsWith("text/html")</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:testStep type="httprequest" name="DuplicateSession" id="c12c9f71-a86d-4b06-940d-5b4cc8cdfc11"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="82940ef5-951e-4615-b686-9c5583880b72" name="DuplicateSession" timeout="" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Must fail due to ducplicate session parameter</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_initialize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="74892484-7dbc-470d-92fe-88b1e6d0da8d" name="status: 400"><con:configuration><codes>400</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="c65a42cd-db65-41fc-973d-ed1b13015d71" name="content-type: text/html"><con:configuration><scriptText>// Check content-type
assert messageExchange.responseHeaders["Content-Type"].get(0).startsWith("text/html")</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>session</con:name><con:value>unknownSession</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>session</con:name><con:value>duplicateParameter</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="UnknownSession" id="d3cb7ed4-0817-4b45-8183-3ecc42e3210c"><con:settings/><con:config method="POST" xsi:type="con:HttpRequest" id="82940ef5-951e-4615-b686-9c5583880b72" name="UnknownSession" timeout="" postQueryString="true" mediaType="application/x-www-form-urlencoded" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Must fail due to unknown session value</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_initialize}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="74892484-7dbc-470d-92fe-88b1e6d0da8d" name="status: 400"><con:configuration><codes>400</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="c65a42cd-db65-41fc-973d-ed1b13015d71" name="content-type: text/html"><con:configuration><scriptText>// Check content-type
assert messageExchange.responseHeaders["Content-Type"].get(0).startsWith("text/html")</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>session</con:name><con:value>unknownSession</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:testSuite id="67bd5a03-cc9c-4d47-872f-d11fdd93b8e7" name="Callback"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="04a57bcf-b836-4108-af15-8136bf81ede1" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Callback" searchProperties="true"><con:settings/><con:testStep type="httprequest" name="MissingState" id="e33d244a-ea7a-410e-8c5d-c47164d9c19e"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="c5bd8826-060d-4544-ad73-b0aa7c02867b" name="MissingState" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Must fail due to missing state</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_callback}</con:endpoint><con:request/><con:assertion type="GroovyScriptAssertion" id="f50edc2e-367e-4b0e-9b6c-ce0dface803e" name="content-type: text/html"><con:configuration><scriptText>// Check content-type
assert messageExchange.responseHeaders["Content-Type"].get(0).startsWith("text/html")</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" id="c60a6cbd-16f6-4789-9247-b2bb76734e04" name="status: 400"><con:configuration><codes>400</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:testStep type="httprequest" name="DuplicateState" id="09afbad9-86b7-4448-9342-ac40b56454dc"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="c5bd8826-060d-4544-ad73-b0aa7c02867b" name="DuplicateState" postQueryString="true" mediaType="application/x-www-form-urlencoded" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Must fail due to duplicate state parameter</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_callback}</con:endpoint><con:request/><con:assertion type="GroovyScriptAssertion" id="f50edc2e-367e-4b0e-9b6c-ce0dface803e" name="content-type: text/html"><con:configuration><scriptText>// Check content-type
assert messageExchange.responseHeaders["Content-Type"].get(0).startsWith("text/html")</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" id="c60a6cbd-16f6-4789-9247-b2bb76734e04" name="status: 400"><con:configuration><codes>400</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>state</con:name><con:value>unknownState</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>state</con:name><con:value>anotherUnknownState</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="httprequest" name="UnknownState" id="13656214-f518-4d05-9ac3-b09984bf881c"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="c5bd8826-060d-4544-ad73-b0aa7c02867b" name="UnknownState" postQueryString="true" mediaType="application/x-www-form-urlencoded" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Must fail due to unknown state value</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_callback}</con:endpoint><con:request/><con:assertion type="GroovyScriptAssertion" id="f50edc2e-367e-4b0e-9b6c-ce0dface803e" name="content-type: text/html"><con:configuration><scriptText>// Check content-type
assert messageExchange.responseHeaders["Content-Type"].get(0).startsWith("text/html")</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" id="c60a6cbd-16f6-4789-9247-b2bb76734e04" name="status: 400"><con:configuration><codes>400</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" id="510fe935-7e1c-4f62-9003-02bd586b9032" name="contains: expired"><con:configuration><token>expired</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>state</con:name><con:value>unknownState</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:testSuite id="a29e5bbc-c183-4e62-9cb5-7da068cd05ec" name="Discovery"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="ad28cfa0-63a6-461f-a490-643a5b965aa0" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="GET Discovery Document" searchProperties="true"><con:settings/><con:testStep type="httprequest" name="Discovery" id="60c37446-a6fe-432d-80f4-0120bce34a4b"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="a24efa6f-c2dc-42de-b1fc-40b00b88f62b" name="Discovery" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_discovery}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="e0691160-f53c-4642-a0f6-b5453511dff2" name="status=200"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="c508be69-641e-49c8-8d8b-949bb2ce3d05" name="issuer=host"><con:configuration><path>issuer</path><content>${#Project#host}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:properties><con:property><con:name>host</con:name><con:value>https://local.loginbuddy.net</con:value></con:property><con:property><con:name>host_http</con:name><con:value>http://local.loginbuddy.net</con:value></con:property><con:property><con:name>path_authorize</con:name><con:value>/authorize</con:value></con:property><con:property><con:name>path_initialize</con:name><con:value>/initialize</con:value></con:property><con:property><con:name>path_token</con:name><con:value>/token</con:value></con:property><con:property><con:name>path_callback</con:name><con:value>/callback</con:value></con:property><con:property><con:name>path_discovery</con:name><con:value>/.well-known/openid-configuration</con:value></con:property><con:property><con:name>path_providers_jsp</con:name><con:value>/iapis/providers.jsp</con:value></con:property><con:property><con:name>path_error_jsp</con:name><con:value>/iapis/error.jsp</con:value></con:property><con:property><con:name>client_id</con:name><con:value>clientIdForSoapUiTestingPurposes</con:value></con:property><con:property><con:name>client_secret</con:name><con:value>d5453153-e096-4672-bcb5-313d9847c8de</con:value></con:property><con:property><con:name>redirect_uri</con:name><con:value>https://local.soapui.com/redirect</con:value></con:property><con:property><con:name>provider_test</con:name><con:value>server_loginbuddy</con:value></con:property><con:property><con:name>host_fake_Server</con:name><con:value>https://demoserver.loginbuddy.net</con:value></con:property><con:property><con:name>email</con:name><con:value>fake@emailaddress.com</con:value></con:property><con:property><con:name>password</con:name><con:value>fakePAssword</con:value></con:property><con:property><con:name>state</con:name><con:value>sopauiFakeState</con:value></con:property></con:properties><con:wssContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/><con:sensitiveInformation/></con:soapui-project>